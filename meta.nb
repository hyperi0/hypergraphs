(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     72624,       1523]
NotebookOptionsPosition[     67530,       1428]
NotebookOutlinePosition[     67920,       1444]
CellTagsIndexPosition[     67877,       1441]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Applying Wolfram model transformations to Wolfram model rules\
\>", "Text",
 CellChangeTimes->{{3.91796387315049*^9, 
  3.9179638887407207`*^9}},ExpressionUUID->"e51c8c07-76aa-4455-a590-\
c7b14a4c5798"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wm", " ", "=", " ", 
  RowBox[{"ResourceFunction", "[", "\"\<WolframModel\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.91796393246332*^9, 3.9179639391788054`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"854151f4-83d8-48de-ae36-d3f9db7ddb25"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   DynamicModuleBox[{Typeset`open = False}, 
    FrameBox[
     PaneSelectorBox[{False->GridBox[{
        {
         PaneBox[GridBox[{
            {
             StyleBox[
              StyleBox[
               AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                BoxBaselineShift->-0.25,
                BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",
               
               FontColor->RGBColor[
                0.8745098039215686, 0.2784313725490196, 0.03137254901960784]],
              
              ShowStringCharacters->False,
              FontFamily->"Source Sans Pro Black",
              FontSize->0.6538461538461539 Inherited,
              FontWeight->"Heavy",
              PrivateFontOptions->{"OperatorSubstitution"->False}], 
             StyleBox[
              RowBox[{
               StyleBox["WolframModel", "ResourceFunctionLabel"], " "}],
              ShowAutoStyles->False,
              ShowStringCharacters->False,
              FontSize->Rational[12, 13] Inherited,
              FontColor->GrayLevel[0.1]]}
           },
           GridBoxSpacings->{"Columns" -> {{0.25}}}],
          Alignment->Left,
          BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
          BaselinePosition->Baseline,
          FrameMargins->{{3, 0}, {0, 0}}], 
         ItemBox[
          PaneBox[
           TogglerBox[Dynamic[Typeset`open], {True->
            
            DynamicBox[FEPrivate`FrontEndResource[
             "FEBitmaps", "IconizeCloser"],
             ImageSizeCache->{11., {1., 10.}}], False->
            
            DynamicBox[FEPrivate`FrontEndResource[
             "FEBitmaps", "IconizeOpener"],
             ImageSizeCache->{11., {1., 10.}}]},
            Appearance->None,
            BaselinePosition->Baseline,
            ContentPadding->False,
            FrameMargins->0],
           Alignment->Left,
           BaselinePosition->Baseline,
           FrameMargins->{{1, 1}, {0, 0}}],
          Frame->{{
             RGBColor[
             0.8313725490196079, 0.8470588235294118, 0.8509803921568627, 0.5],
              False}, {False, False}}]}
       },
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
       
       GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}], True->GridBox[{
        {GridBox[{
           {
            PaneBox[GridBox[{
               {
                StyleBox[
                 AdjustmentBox[
                  
                  StyleBox["\<\"[\[FilledSmallSquare]]\"\>", 
                   "ResourceFunctionIcon",
                   
                   FontColor->RGBColor[
                    0.8745098039215686, 0.2784313725490196, 
                    0.03137254901960784]],
                  BoxBaselineShift->-0.25,
                  BoxMargins->{{0, 0}, {-1, -1}}],
                 ShowStringCharacters->False,
                 FontFamily->"Source Sans Pro Black",
                 FontSize->0.6538461538461539 Inherited,
                 FontWeight->"Heavy",
                 PrivateFontOptions->{"OperatorSubstitution"->False}], 
                StyleBox[
                 RowBox[{
                  StyleBox["WolframModel", "ResourceFunctionLabel"], " "}],
                 ShowAutoStyles->False,
                 ShowStringCharacters->False,
                 FontSize->Rational[12, 13] Inherited,
                 FontColor->GrayLevel[0.1]]}
              },
              GridBoxSpacings->{"Columns" -> {{0.25}}}],
             Alignment->Left,
             BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
             BaselinePosition->Baseline,
             FrameMargins->{{3, 0}, {0, 0}}], 
            ItemBox[
             PaneBox[
              TogglerBox[Dynamic[Typeset`open], {True->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "IconizeCloser"]], False->
               
               DynamicBox[FEPrivate`FrontEndResource[
                "FEBitmaps", "IconizeOpener"]]},
               Appearance->None,
               BaselinePosition->Baseline,
               ContentPadding->False,
               FrameMargins->0],
              Alignment->Left,
              BaselinePosition->Baseline,
              FrameMargins->{{1, 1}, {0, 0}}],
             Frame->{{
                RGBColor[
                0.8313725490196079, 0.8470588235294118, 0.8509803921568627, 
                 0.5], False}, {False, False}}]}
          },
          BaselinePosition->{1, 1},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}]},
        {
         StyleBox[
          PaneBox[GridBox[{
             {
              RowBox[{
               TagBox["\<\"Version (latest): \"\>",
                "IconizedLabel"], " ", 
               TagBox["\<\"7.0.0\"\>",
                "IconizedItem"]}]},
             {
              TagBox[
               
               TemplateBox[{
                "\"Documentation \[RightGuillemet]\"", 
                 "https://resources.wolframcloud.com/FunctionRepository/\
resources/f6eb4e01-15fd-4c52-857b-52f627495c74/"},
                "HyperlinkURL"],
               "IconizedItem"]}
            },
            DefaultBaseStyle->"Column",
            GridBoxAlignment->{"Columns" -> {{Left}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
           Alignment->Left,
           BaselinePosition->Baseline,
           FrameMargins->{{5, 4}, {0, 4}}], "DialogStyle",
          FontFamily->"Roboto",
          FontSize->11]}
       },
       BaselinePosition->{1, 1},
       GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
       GridBoxDividers->{"Columns" -> {{None}}, "Rows" -> {False, {
            GrayLevel[0.8]}, False}},
       GridBoxItemSize->{
        "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
      Typeset`open],
      BaselinePosition->Baseline,
      ImageSize->Automatic],
     Background->RGBColor[
      0.9686274509803922, 0.9764705882352941, 0.984313725490196],
     BaselinePosition->Baseline,
     DefaultBaseStyle->{},
     FrameMargins->{{0, 0}, {1, 0}},
     FrameStyle->RGBColor[
      0.8313725490196079, 0.8470588235294118, 0.8509803921568627],
     RoundingRadius->4]],
   {"FunctionResourceBox", 
    RGBColor[0.8745098039215686, 0.2784313725490196, 0.03137254901960784], 
    "WolframModel"},
   TagBoxNote->"FunctionResourceBox"],
  ResourceFunction[
   ResourceObject[
    Association[
    "Name" -> "WolframModel", "ShortName" -> "WolframModel", "UUID" -> 
     "f6eb4e01-15fd-4c52-857b-52f627495c74", "ResourceType" -> "Function", 
     "Version" -> "7.0.0", "Description" -> 
     "Generate evolutions of Wolfram model systems", "RepositoryLocation" -> 
     URL["https://www.wolframcloud.com/obj/resourcesystem/api/1.0"], 
     "SymbolName" -> 
     "FunctionRepository`$45fbed846bc742f99ba5a5e8c18f5c5b`WolframModel", 
     "FunctionLocation" -> 
     CloudObject[
      "https://www.wolframcloud.com/obj/05ace420-737e-4ee5-ab94-0974e563037f"]\
], ResourceSystemBase -> Automatic]],
  Selectable->False]], "Output",
 CellChangeTimes->{3.917963946161998*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"6509b146-d030-4e38-b02f-41e59bc84aa4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rule", " ", "=", " ", 
  RowBox[{
   RowBox[{"ResourceFunction", "[", "\"\<RandomWolframModel\>\"", "]"}], "[", 
   
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"4", ",", "2"}], "}"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.917963940928021*^9, 3.917963957511421*^9}, {
  3.917963989005715*^9, 3.9179640034017487`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"04583e98-4db3-4f3d-a259-59abb8262500"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "3"}], "}"}]}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "1"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{{3.917964004120928*^9, 3.917964039954965*^9}, {
  3.917964108389979*^9, 3.917964127000361*^9}},
 CellLabel->"Out[47]=",ExpressionUUID->"a30fb799-45bd-44eb-84e1-02f58bcb340e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wm", "[", 
  RowBox[{
  "rule", ",", " ", "Automatic", ",", " ", "3", ",", " ", 
   "\"\<FinalStatePlot\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9179640046865997`*^9, 3.91796401304361*^9}, 
   3.917964200733515*^9},
 CellLabel->"In[50]:=",ExpressionUUID->"a36710c9-3ad5-42df-9782-5c7854e52c02"],

Cell[BoxData[
 GraphicsBox[{{
    {Hue[0.63, 0.7, 0.5], Opacity[0.7], {LineBox[CompressedData["
1:eJwBoQFe/iFib1JlAgAAABkAAAACAAAAvwNLvzfGB0A+RVdkvDb0P4bhtisG
AAtAkKwYS3W88T8ZlXGbUCULQDp+vtaBmPE/ixJHeyVHC0D2jtQoy2jxP4OJ
5IGZZAtAWzkjFp0u8T9YOBLZ33wLQPCFrz2M6/A/xLZErk+PC0Dr1bsKa6Hw
PyiutshomwtAgl8ACT1S8D/jiiUF16ALQNjSOuMoAPA/b2/3nnSfC0B8O/na
0lrvP1Hp5DZLlwtAc/SDRny47j+PrQOQk4gLQIs0Vgq3He4/JggEBbRzC0BF
uSOGt47tPw5pWsA9WQtA5spGOmAP7T9Ro6vK6DkLQOVNWMMmo+w/3R7pCo8W
C0AF3hHL+0zsP7wr4lom8ApAv27MlTYP7D+hwnXZuccKQOSTz7qE6+s/F8vX
qGKeCkAfQ6p43uLrP2rBYUtAdQpARiG/9n/16z9VWwzUcE0KQHs466LnIuw/
xSjkIAkoCkAdj6S22WnsP8zEhVUNBgpAmKcVy2jI7D+h3fDJaegJQFjCjEAD
PO0/xX2itWN1CEAK1BgkyPPxPzdFuiI=
       "]], 
      PolygonBox[{{3.101804692212268, 1.1396382519442805`}, {
       3.096315927836991, 1.1381926033746281`}, {3.083387115295135, 
       1.1343029501449307`}, {3.0758721369318405`, 1.1315977566257538`}, {
       3.0685565486753443`, 1.1286634126094424`}, {3.062133682356282, 
       1.1253966867524772`}, {3.0573190870488554`, 1.122017041210031}, {
       3.0537029683179635`, 1.1180692445797726`}, {3.049687894510829, 
       1.1122639745975669`}, {3.045533248220463, 1.1052291179070952`}, {
       3.041463043145631, 1.097865204430445}, {3.034949773858692, 
       1.0848570326752134`}, {3.0322945321492543`, 1.0792244274494371`}, {
       2.9551340721731014`, 1.2395877594925881`}, {3.101804692212268, 
       1.1396382519442805`}}]}, {
      LineBox[{{2.9374629186203043`, 1.3408166026356352`}, {
       3.3115180107324256`, 2.305646465603674}}], 
      PolygonBox[{{3.34786053762474, 2.274522570063796}, {3.34402083100646, 
       2.2787026522687035`}, {3.334547928678771, 2.288322824693344}, {
       3.32864875748157, 2.293707316402233}, {3.3226399465842453`, 
       2.2988085317422122`}, {3.316753702697156, 2.3029650738722536`}, {
       3.3115180107324256`, 2.305646465603674}, {3.30633902212559, 
       2.307002743569304}, {3.2993310067903425`, 2.3078451795039463`}, {
       3.2911703382884667`, 2.308237332606714}, {3.282758030728033, 
       2.3084012611016522`}, {3.26821362313715, 2.3080923646010802`}, {
       3.261992826984291, 2.307812640827427}, {3.367825427199444, 
       2.450884635219806}, {3.34786053762474, 2.274522570063796}}]}, {
      LineBox[{{3.7351467157976637`, 1.947729126117394}, {3.08352606498213, 
       1.4205813604930893`}}], 
      PolygonBox[{{3.0674861696462488`, 1.4656612661286366`}, {
       3.0687371649162367`, 1.460124891413291}, {3.0721680093969637`, 
       1.4470668325170073`}, {3.0746062396639706`, 1.439461044921891}, {
       3.077280516046439, 1.4320464341988104`}, {3.080318480030769, 
       1.4255122560250058`}, {3.08352606498213, 1.4205813604930893`}, {
       3.0873437529233096`, 1.4168281389843642`}, {3.093003673541547, 
       1.4126106425897849`}, {3.0998874876680085`, 1.4082102565242391`}, {
       3.1071031342604307`, 1.4038826434065896`}, {3.119873281750917, 
       1.3969142474441738`}, {3.1254086470339724`, 1.394061830688487}, {
       2.9624215092496624`, 1.3226102543266478`}, {3.0674861696462488`, 
       1.4656612661286366`}}]}, {
      LineBox[{{3.564572921966831, 0.4392072406488193}, {3.047114282248295, 
       1.1136807532939896`}}], 
      PolygonBox[{{3.092592543317017, 1.128553678516052}, {
       3.0870257706985655`, 1.1274457630099266`}, {3.0738836400263936`, 
       1.1243525450439082`}, {3.066217548380857, 1.1221111145499565`}, {
       3.0587364875580385`, 1.1196287899720792`}, {3.0521261952218897`, 
       1.1167602110891193`}, {3.047114282248295, 1.1136807532939896`}, {
       3.043263930764581, 1.1099610481495399`}, {3.0389019868977845`, 
       1.1044116857586022`}, {3.034325676129107, 1.0976435490724819`}, {
       3.029813563301278, 1.0905418148566919`}, {3.022518413099695, 
       1.0779554733408208`}, {3.019524305188142, 1.0724954488006788`}, {
       2.952296397678468, 1.237269667960061}, {3.092592543317017, 
       1.128553678516052}}]}, {
      LineBox[{{2.9729945810388303`, 1.2668223503485447`}, {4.12508383956304, 
       0.9033707253174109}}], 
      PolygonBox[{{4.0963579355415956`, 0.8651045709163393}, {
       4.100282821609024, 0.869204778656437}, {4.109274831374035, 
       0.8792758936084025}, {4.1142693915643225`, 0.8855086570631281}, {
       4.1189742194845005`, 0.891832643194214}, {4.122744194650134, 
       0.8979736526248872}, {4.12508383956304, 0.9033707253174108}, {
       4.126104746906657, 0.9086261188426888}, {4.126495420896612, 
       0.9156737674630878}, {4.126362723215238, 0.9238427751004253}, {
       4.125986112841333, 0.932248246869996}, {4.124743877492143, 
       0.9467427996590618}, {4.124065259522617, 0.9529327938283978}, {
       4.273638054427318, 0.856506065831905}, {4.0963579355415956`, 
       0.8651045709163393}}]}, {
      LineBox[{{2.859077948825193, 1.3045081617136294`}, {2.1394319795386667`,
        1.5537276415351686`}}], 
      PolygonBox[{{2.1692101619750925`, 1.5911807586988813`}, {
       2.165172851634527, 1.5871912024117472`}, {2.1559044498757247`, 
       1.5773738542551838`}, {2.1507386172615788`, 1.5712822908122241`}, {
       2.1458598700554568`, 1.5650914885989886`}, {2.141920699288044, 
       1.5590576139531018`}, {2.1394319795386667`, 1.5537276415351686`}, {
       2.138265425182064, 1.5485026473875283`}, {2.1376790561091203`, 
       1.541468576833906}, {2.1375846953272237`, 1.5332990364247792`}, {
       2.137727581979504, 1.5248863451522205`}, {2.138566550839487, 
       1.5103628696566729`}, {2.1390728940015786`, 1.504156407962021}, {
       1.9922374483373197`, 1.6047023514122267`}, {2.1692101619750925`, 
       1.5911807586988813`}}]}, {
      LineBox[{{2.43439953225657, 0.16673989666432532`}, {2.8304524571414853`,
        1.0866885483312052`}}], 
      PolygonBox[{{2.865629037698393, 1.0542526991081733`}, {
       2.8619452224852577`, 1.0585707935524535`}, {2.8528315214778894`, 
       1.0685319204936203`}, {2.847133800017206, 1.074129146765038}, {
       2.841316123216242, 1.0794473083820042`}, {2.8355862842627126`, 
       1.0838169371012119`}, {2.8304524571414853`, 1.0866885483312052`}, {
       2.825326695543276, 1.0882338576685573`}, {2.8183542921616773`, 
       1.0893327518069125`}, {2.810213496592281, 1.090023940602265}, {
       2.801812860929928, 1.090496287414664}, {2.7872669095630767`, 
       1.0907210273776897`}, {2.781040039562836, 1.090669644840926}, {
       2.89204872542191, 1.2297638809240754`}, {2.865629037698393, 
       1.0542526991081733`}}]}, {
      LineBox[{{5.2216730604891035`, 1.0046072874354715`}, {4.542971345881466,
        0.8780175273821099}}], 
      PolygonBox[{{4.5503086506041965`, 0.9253000832976024}, {
       4.548775196317402, 0.9198351997577122}, {4.545580828624832, 
       0.906717287918002}, {4.544107174469841, 0.8988673633827945}, {
       4.5429320930064305`, 0.8910733021885904}, {4.542495756125028, 
       0.8838806448421683}, {4.542971345881466, 0.8780175273821099}, {
       4.544543831737039, 0.872900037651411}, {4.547515860199836, 
       0.8664977705483164}, {4.551477408803835, 0.8593523925239099}, {
       4.555765454664257, 0.8521131623340555}, {4.563682892485799, 
       0.8399086800607347}, {4.567194772344895, 0.8347663799897305}, {
       4.389841033463294, 0.8494560414027807}, {4.5503086506041965`, 
       0.9253000832976024}}]}, {
      LineBox[{{2.8559841345217034`, 1.2798613381412152`}, {1.410143049533671,
        1.1586529939120243`}}], 
      PolygonBox[{{1.4221993567362652`, 1.204957654488823}, {
       1.4201239601052662`, 1.1996747421312035`}, {1.4156262456700515`, 
       1.186944692608558}, {1.4133704312358482`, 1.1792828212304014`}, {
       1.4114172944510135`, 1.1716464959986965`}, {1.410259651260074, 
       1.1645342128336655`}, {1.410143049533671, 1.1586529939120243`}, {
       1.4111927839923109`, 1.1534032824460358`}, {1.4135057247706921`, 
       1.1467345282746229`}, {1.4167284160978184`, 1.1392268951546851`}, {
       1.4202665079080479`, 1.1315930430874015`}, {1.4269161210857435`, 
       1.1186540379554446`}, {1.4298929168882293`, 1.1131845556293665`}, {
       1.2549164014847949`, 1.1456399697383424`}, {1.4221993567362652`, 
       1.204957654488823}}]}, {
      LineBox[{{2.9232220541742784`, 1.2253377240508225`}, {
       3.0497224994184764`, 0.21410243480797359`}}], 
      PolygonBox[{{3.0029644945617386`, 0.22425945781243511`}, {
       3.008327684799383, 0.2224013338582576}, {3.0212306424718536`, 
       0.21842675472428852`}, {3.028978171923507, 0.21648542549596672`}, {
       3.0366878271543145`, 0.21484547959236816`}, {3.043841420281384, 
       0.21397898380503977`}, {3.0497224994184764`, 0.21410243480797359`}, {
       3.054925010049255, 0.21536548510246734`}, {3.0614938425500213`, 
       0.2179485872723235}, {3.0688637373645427`, 0.22147490899281486`}, {
       3.076346877584535, 0.22532151834271258`}, {3.0890038022950197`, 
       0.23249351012260916`}, {3.0943472760599455`, 0.23569098385800244`}, {
       3.0690579854398683`, 0.05953597647062584}, {3.0029644945617386`, 
       0.22425945781243511`}}]}, {
      LineBox[{{2.1497196085989145`, 2.249827076215349}, {2.7816150653468235`,
        1.4538661888130004`}}], 
      PolygonBox[{{2.7363895685812, 1.4382415103587585`}, {2.741937212919536, 
       1.4394415422123268`}, {2.755026268530187, 1.4427521643911678`}, {
       2.762654155640574, 1.4451203514632058`}, {2.77009304455776, 
       1.4477263326646763`}, {2.7766548824922896`, 1.4507040822340787`}, {
       2.7816150653468235`, 1.4538661888130004`}, {2.785403234260243, 
       1.4576492020555347`}, {2.789672598942925, 1.463270100778097}, {
       2.794136100051162, 1.4701131594736139`}, {2.7985298827011706`, 
       1.4772887057989654`}, {2.805615413746711, 1.4899942344782637`}, {
       2.808518611140832, 1.4955031359164588`}, {2.8784683950002523`, 
       1.3318658462000441`}, {2.7363895685812, 1.4382415103587585`}}]}, {
      LineBox[{{0.05980447449974293, 1.048747082704563}, {0.9800581292354457, 
       1.1232223540865012`}}], 
      PolygonBox[{{0.967868340388485, 1.0769526536080847`}, {
       0.9699589630694073, 1.0822295590421684`}, {0.9744933692784356, 
       1.0949465852795115`}, {0.9767712693719409, 1.102601919559671}, {
       0.9787464194055377, 1.1102325806509155`}, {0.9799245679386012, 
       1.1173414958713377`}, {0.9800581292354456, 1.1232223540865012`}, {
       0.9790235380776311, 1.128475070911722}, {0.976729838038731, 
       1.135150467332504}, {0.973528810363919, 1.1426673627208015`}, {
       0.9700127475032834, 1.1503113860726}, {0.9634004750296007, 
       1.1632695133273991`}, {0.9604394643083655, 1.168747557291599}, {
       1.1353216583506895`, 1.1357876869238874`}, {0.967868340388485, 
       1.0769526536080847`}}]}, {
      LineBox[{{2.9755898888386345`, 1.2895755802049798`}, {4.181423280930795,
        1.384361795903204}}], 
      PolygonBox[{{4.169126734752306, 1.3381203525155223`}, {
       4.171229530886292, 1.3433924187682496`}, {4.175793275730544, 
       1.356098945791253}, {4.178088838157609, 1.3637490023217906`}, {
       4.180081594385748, 1.3713750844718766`}, {4.181276147054184, 
       1.378481261608667}, {4.181423280930795, 1.384361795903204}, {
       4.180400815722786, 1.3896168865597194`}, {4.178122528511083, 
       1.3962975590276698`}, {4.174938858247463, 1.4038218223209142`}, {
       4.171440447046582, 1.4114739403357077`}, {4.164858099353863, 
       1.4244472941068012`}, {4.161909739765032, 1.42993215745058}, {
       4.336715397122835, 1.3965687493000356`}, {4.169126734752306, 
       1.3381203525155223`}}]}, {
      LineBox[{{2.8664330702280347`, 1.2507352637545839`}, {2.181450971728758,
        0.7768076929254814}}], 
      PolygonBox[{{2.168830978420445, 0.8229619116210026}, {
       2.1696639845179786`, 0.8173474183227858}, {2.1721076146063782`, 
       0.8040691553346982}, {2.173969598191745, 0.7963021746533266}, {
       2.176081277859463, 0.7887081628462779}, {2.178621537751615, 
       0.7819648855082593}, {2.181450971728758, 0.7768076929254814}, {
       2.184976962670647, 0.7727791943481576}, {2.190305258689642, 
       0.7681498057517013}, {2.1968403216507153`, 0.7632464144203538}, {
       2.2037117339769616`, 0.7583907493077775}, {2.2159243584799273`, 
       0.7504858766353463}, {2.22123064485232, 0.7472270616514691}, {
       2.0533517024727557`, 0.6881779672195266}, {2.168830978420445, 
       0.8229619116210026}}]}, {
      LineBox[{{2.7425959132222486`, 2.471670566585805}, {2.884618827960633, 
       1.4983836983075627`}}], 
      PolygonBox[{{2.837662905486309, 1.507582474263151}, {2.843062969879854, 
       1.5058344071306258`}, {2.8560445032089916`, 1.502124503032911}, {
       2.863830109686602, 1.5003420037895003`}, {2.8715716870753982`, 
       1.4988600503901202`}, {2.878741502860213, 1.4981400148431265`}, {
       2.884618827960633, 1.4983836983075627`}, {2.88979442352841, 
       1.4997528671899854`}, {2.8963090624208485`, 1.5024697509460863`}, {
       2.90360530886475, 1.5061460374261335`}, {2.9110082276871463`, 
       1.5101448602468883`}, {2.9235158506858796`, 1.5175741654727726`}, {
       2.9287928241762593`, 1.5208802357906583`}, {2.907110897795056, 
       1.3442449366114924`}, {2.837662905486309, 1.507582474263151}}]}, {
      LineBox[{{5.225660353369783, 1.0395980706521861`}, {4.594304950229338, 
       1.3150000820108148`}}], 
      PolygonBox[{{4.626908971489524, 1.350020846310887}, {4.622573276053473, 
       1.3463577630139836`}, {4.612568596249959, 1.3372918941632377`}, {
       4.606944134279754, 1.3316210565423314`}, {4.601598159009091, 
       1.3258289278533157`}, {4.597201126612731, 1.3201200912220512`}, {
       4.594304950229338, 1.3150000820108148`}, {4.592735099159314, 
       1.309881783413846}, {4.591602810201772, 1.3029147252857933`}, {
       4.590872623696505, 1.2947773349104306`}, {4.590360031669578, 
       1.286379058869676}, {4.5900655991079535`, 1.2718343512863504`}, {
       4.590087145755442, 1.2656073065693954`}, {4.451526391077937, 
       1.3772811715106317`}, {4.626908971489524, 1.350020846310887}}]}}, 
    {Hue[0.63, 0.26, 0.89], EdgeForm[{Hue[0.63, 0.7, 0.33], Opacity[0.95]}], 
     DiskBox[{2.9157744031560657, 1.2848737005214483}, 0.06], 
     DiskBox[{1.1951261328504326, 1.1406276073581092}, 0.06], 
     DiskBox[{5.280655861642315, 1.0156086131792508}, 0.06], 
     DiskBox[{3.601094916489233, 0.39160320808743204}, 0.06], 
     DiskBox[{4.330858232310082, 0.8384547156590014}, 0.06], 
     DiskBox[{0., 1.0439071622703413}, 0.06], 
     DiskBox[{4.396530882805404, 1.401270628983567}, 0.06], 
     DiskBox[{3.3895139426636827, 2.5068275373339928}, 0.06], 
     DiskBox[{3.7817938218912603, 1.9854656799225934}, 0.06], 
     DiskBox[{1.935540994006447, 1.6243368126044078}, 0.06], 
     DiskBox[{2.4106738545224142, 0.11163007706695245}, 0.06], 
     DiskBox[{3.076505636458081, 0.}, 0.06], 
     DiskBox[{2.112413600443101, 2.2968192218939447}, 0.06], 
     DiskBox[{2.0040103695447247, 0.6540395304526622}, 0.06], 
     DiskBox[{2.733932407861239, 2.531041802675849}, 0.06]}}, {}},
  Background->None,
  ImageSizeRaw->{{360}, {420}}]], "Output",
 CellChangeTimes->{{3.917964010394562*^9, 3.917964040689266*^9}, {
   3.917964110707416*^9, 3.9179641277979727`*^9}, 3.917964200941663*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"1da7c11e-36ab-4781-8a5b-81646f2749ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RulePlot", "[", 
  RowBox[{"wm", "[", "rule", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.91796408544477*^9, 3.917964104657089*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"bb20c6c1-a720-4c74-befc-20b346817341"],

Cell[BoxData[
 GraphicsBox[
  GeometricTransformationBox[
   GeometricTransformationBox[
    GeometricTransformationBox[{
      GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[{{{
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.0497169578717196`, 0.7398389941374303}, {
               1.661617022248567, 0.7398540601716462}}], 
              PolygonBox[{{1.6310311625454754`, 0.6529265070687158}, {
               1.6358639211304735`, 0.6627315260625336}, {1.6465433374077258`,
                0.6864392890153548}, {1.652104984293592, 
               0.7007809259570339}, {1.6570816311877605`, 
               0.7151222184950049}, {1.660447299693889, 0.7285857313676453}, {
               1.661617022248567, 0.7398540601716462}, {1.6604467700244783`, 
               0.7500980113611246}, {1.657080445742627, 0.763268528480411}, {
               1.652103078217638, 0.7781953259335684}, {1.6465407034791542`, 
               0.7934150889829288}, {1.6358600657305087`, 
               0.8193168260150703}, {1.6310267954888604`, 
               0.8302925070149536}, {1.9616170221576328`, 
               0.7398614466887043}, {1.6310311625454754`, 
               0.6529265070687158}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.9616170221276161`, 0.7398641516550276}, {
               0.399999999998821, 0.7398679431669996}}], 
              PolygonBox[{{0.43058821105176, 0.8267946689009237}, {
               0.42575518724606826`, 0.8169897806351851}, {
               0.41507512968571914`, 0.793282306565651}, {0.4095130948654383, 
               0.778940820069894}, {0.4045360600459569, 0.7645996621537922}, {
               0.40117002735757057`, 0.7511362403262769}, {0.399999999998821, 
               0.7398679431669996}, {0.4011699751270518, 
               0.7296239603263402}, {0.40453594314961916`, 
               0.716453352153934}, {0.4095129069079428, 0.7015264200701221}, {
               0.4150748699549269, 0.6863065065659664}, {0.4257548070664012, 
               0.6604044806356466}, {0.4305877804178063, 
               0.6494286689014465}, {0.09999999999970526, 
               0.739868671548911}, {0.43058821105176, 
               0.8267946689009237}}]}}}, {
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0.949716957902031, 0.7398365319650775}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.0616170221273213, 0.7398639088610571}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0., 0.7398689143428815}, 0.1]}}}, {}, 
          {GrayLevel[0.7], 
           LineBox[{{-0.38876863264269934`, -0.26798977668602764`}, {
            3.076454959069691, -0.26798977668602764`}, {3.076454959069691, 
            1.7478875435463053`}, {-0.38876863264269934`, 
            1.7478875435463053`}, {-0.38876863264269934`, \
-0.26798977668602764`}}]}}, {0.38876863264269934`, 0.26798977668602764`}], {{{
         0.2885816668198994, 0.}, {0., 0.2885816668198994}}, {0., 0.}}], {0, 
       0}], GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[
         {GrayLevel[0.65], 
          FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
           0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{-1., 
           0.1848}, {0.2991, 0.1848}, {-0.1531, 0.6363}, {0.109, 0.8982}, {1.,
            0.0034}, {0.109, -0.8982}, {-0.1531, -0.6363}, {
           0.2991, -0.1848}, {-1., -0.1848}, {-1., 0.1848}}}]}, {1.4, 
         0.29087261858853936`}], {{{0.075, 0.}, {0., 0.075}}, {0., 
         0.2690571721943989}}], {1., 0}], 
      GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[{{{
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.9616170221576328`, 0.7398614466887043}, {
               1.3497169577807853`, 0.7398463806544884}}], 
              PolygonBox[{{1.380302817483877, 0.8267739337574188}, {
               1.3754700588988789`, 0.816968914763601}, {1.3647906426216265`, 
               0.7932611518107798}, {1.3592289957357604`, 
               0.7789195148691007}, {1.3542523488415918`, 
               0.7645782223311297}, {1.3508866803354633`, 
               0.7511147094584893}, {1.3497169577807853`, 
               0.7398463806544884}, {1.350887210004874, 0.72960242946501}, {
               1.3542535342867255`, 0.7164319123457236}, {1.3592309018117144`,
                0.7015051148925662}, {1.3647932765501982`, 
               0.6862853518432058}, {1.3754739142988437`, 
               0.6603836148110643}, {1.380307184540492, 0.6494079338111811}, {
               1.0497169578717196`, 0.7398389941374303}, {1.380302817483877, 
               0.8267739337574188}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{2.126213086886055, 0.6635268378032451}, {
               2.429302067392056, 0.30534828423124816`}}], 
              PolygonBox[{{2.343186050019372, 0.2725469755057166}, {
               2.353792751309309, 0.27519118441502166`}, {2.3787892221465725`,
                0.28235249727872413`}, {2.3933299363142093`, 
               0.2873706740138625}, {2.4074925115906733`, 
               0.2928352094476754}, {2.419944403256371, 
               0.29896254959741625`}, {2.429302067392056, 
               0.30534828423124827`}, {2.4363662477261268`, 
               0.3128586359172964}, {2.444245994467088, 0.3239358310342162}, {
               2.4524258218511883`, 0.3373773299704479}, {2.4604514146072356`,
                0.3514546543228979}, {2.4733253830363973`, 
               0.37633912620567955`}, {2.478582059471771, 
               0.3871184317256927}, {2.6230902616682577`, 
               0.07633707105781207}, {2.343186050019372, 
               0.2725469755057166}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{2.6228661908756083`, 1.4035407844275478`}, {
               2.319907129836241, 1.0452918385919754`}}], 
              PolygonBox[{{2.273283892967408, 1.124778743715478}, {
               2.277649828511562, 1.1147571390618163`}, {2.288855814245973, 
               1.0912936815167276`}, {2.2962150269338704`, 
               1.0777860372045505`}, {2.30395173692625, 
               1.0647252943289438`}, {2.3120584945498224`, 
               1.0534614413381793`}, {2.319907129836241, 
               1.0452918385919754`}, {2.328484622410302, 
               1.0395704185425183`}, {2.3407148063949577`, 
               1.0336360053397262`}, {2.3553263267422735`, 
               1.027797602918997}, {2.3705393070592446`, 
               1.0222167042561079`}, {2.3972136385247986`, 
               1.0136460540552323`}, {2.4087152184290432`, 
               1.0102490356057274`}, {2.1261895490545513`, 
               0.8162208912937867}, {2.273283892967408, 
               1.124778743715478}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{0.09999999994187017, 0.7398655046556567}, {
               0.5497169581345505, 0.7398501707139766}}], 
              PolygonBox[{{0.5191259942203367, 0.6529244137196354}, {
               0.52395932853395, 0.6627291489237522}, {0.5346401368793405, 
               0.6864362847553754}, {0.5402026258764007, 
               0.7007775951002353}, {0.5451801148625489, 
               0.7151185953917657}, {0.548546573921445, 0.7285819106138675}, {
               0.5497169581345505, 0.7398501707139766}, {0.5485473074229079, 
               0.7500941906013624}, {0.5451817565011302, 
               0.7632649053637783}, {0.5402052654653076, 
               0.7781919950552345}, {0.5346437844195266, 
               0.7934120846931906}, {0.5239646676029199, 
               0.8193144488327294}, {0.5191320418461798, 
               0.8302904136165328}, {0.8497169579601609, 
               0.7398399416523023}, {0.5191259942203367, 
               0.6529244137196354}}]}}}, {
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0.949716957902031, 0.7398365319650775}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.0616170221273213, 0.7398639088610571}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0., 0.7398689143428815}, 0.1]}, 
            {Hue[0.63, 0.26, 0.89], EdgeForm[{Hue[0.63, 0.7, 0.33], Opacity[
             0.95]}], DiskBox[{2.6876863264269915, 0.}, 0.1]}, 
            {Hue[0.63, 0.26, 0.89], EdgeForm[{Hue[0.63, 0.7, 0.33], Opacity[
             0.95]}], 
             DiskBox[{2.6874387178028383, 1.4798977668602773}, 0.1]}}}, {}, 
          {GrayLevel[0.7], 
           LineBox[{{-0.38876863264269934`, -0.26798977668602764`}, {
            3.076454959069691, -0.26798977668602764`}, {3.076454959069691, 
            1.7478875435463053`}, {-0.38876863264269934`, 
            1.7478875435463053`}, {-0.38876863264269934`, \
-0.26798977668602764`}}]}}, {0.38876863264269934`, 0.26798977668602764`}], {{{
         0.2885816668198994, 0.}, {0., 0.2885816668198994}}, {0., 0.}}], {
       1.21, 0}]}, {0.13, 0.13}], {{{0.9999999999999999, 0.}, {0., 
     0.9999999999999999}}, {0., 0.}}], {0, 0}],
  Background->None,
  ImageSizeRaw->318.7199999999999,
  PlotRange->{{-0.01, 2.4799999999999995`}, {-0.01, 
   0.8517452371770787}}]], "Output",
 CellChangeTimes->{{3.917964087327137*^9, 3.9179641311135263`*^9}},
 CellLabel->"Out[49]=",ExpressionUUID->"86145faf-2f10-4fcf-bdb2-206ab4533e0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wm", "[", 
  RowBox[{
  "rule", ",", " ", "Automatic", ",", " ", "2", ",", " ", 
   "\"\<FinalState\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9179643946716022`*^9, 3.917964404477003*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"60b58a8f-9f64-45f0-83b8-94959425305a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.917964404800108*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"4265e04c-921f-449b-9545-2a271a6dd7d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rule", " ", "=", " ", 
  RowBox[{
   RowBox[{
   "ResourceFunction", "[", "\"\<CanonicalWolframModelRule\>\"", "]"}], "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "z"}], "}"}]}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "z"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "w"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "w"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.91796408544477*^9, 3.917964104657089*^9}, {
  3.9179650913788557`*^9, 3.917965111036544*^9}, {3.917965170311935*^9, 
  3.917965177349975*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"7953a065-6d22-4939-82ca-049593a387cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{{3.917964087327137*^9, 3.917964117977311*^9}, 
   3.9179651147867537`*^9, {3.9179651726273603`*^9, 3.917965177659443*^9}},
 CellLabel->"Out[54]=",ExpressionUUID->"aed7836a-48d5-4540-a58b-b2fcb1721eb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DirectedGraph", "[", 
  RowBox[{"rule", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.917965200567622*^9, 3.917965258582223*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"13ca6d7b-97be-4dd9-bae8-1a987e1b4f54"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {
       SparseArray[
       Automatic, {3, 3}, 0, {
        1, {{0, 2, 3, 4}, {{2}, {3}, {1}, {1}}}, Pattern}], Null}]]}, 
    TagBox[GraphicsGroupBox[GraphicsComplexBox[CompressedData["
1:eJxdkmtIk2EUx0dpSiWoEN6maal9KqdYii3OUrALlqLltYmYpkHlMAypoFFQ
EVvMjOkM9fU6bbm2PhQ281kiy7zkDelL5kJQ52W+3qZ5W/Y+py8NXsaBw3n+
l19AdkFi7i4ejxez8/39l/8SyNPX52EkziANNcwL+SMKqd1uB13Y19iZMaWQ
999PeGnVyV27AEyGsSifrQUnN0GAhL8ICt9XJ1dz1VCi6azOkS0C+61SnCfQ
QHfxlaiWrUWQ5BnO3L2ghfjb8HOPZAnWQlSOb8Q6OPRu//ej40uQVbAZdVao
B4VywDaavAyepZk2lw49nFvJbh/qXgbnivu7tVY9VCaYnNPDNqBJReeUt6kD
Fxt35hd0v7OUz257bYL5Fr1XNmSZCpJvQj6+59vXK3tg3wTRNarnckXOkS7J
FjB9VO9Y+O+GNvMW+POpH81CKPGO3wbXdOq3sV18ukM1C7yViGiDpZYE+70e
S/o0A7qPVaoPYjWZ2zYNto5OA6OMZgaDNSRY3HyveMMCxqp6WU+0lqxb7wwf
8LBApE2wbzJFRw5HHHf3Cp0CY12VKfyEnhTdaL269/wkSMXX03oMejJe6aws
zJ4AkUeUJmNKT1KfJFj7Q4aBwTl82prIZA0Ci/v6ZuuMY1A/iOrpvYTuyQl3
eQ904Xt1bn6xTze+AFtN9Tx+pp57WNgJA2VUb62Lz3vvZSPw2qifUx6qzA4H
A0hs1K8a82DSuDzID8xL4cPlRRIxT7aXy5N4Yd6SXC5v8hL7WDvG9UE+Y19Z
tC+ShH160j5JBfbtTPsmschDUzmdZchLUwndP4g8mW/Se3HIWz6+Z0IeRTlU
z3Pklemheh2QZ39v6icSeXdNpX5jMA/eKpcH1GBeOpoXPMI8mXIuT6jBvI0M
lzfEYR+Rq1wf0IJ9GWlfEIZ9SjO5PiEZ+xZ5cn2DGXlgcC5EXljc90eeRA30
3j/euvC9QOSRraF6ZpHXARXVG4g889qpnwbkXbJG/f4BqHgvig==
       "], {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         ArrowBox[BezierCurveBox[{
          1, {1.4996551408641459`, 0.16455400884129318`}, 2}], 
          0.02261146111623527], 
         ArrowBox[BezierCurveBox[{
          1, {0.4996553782289322, -0.16432740746005328`}, 3}], 
          0.02261146111623527], 
         ArrowBox[BezierCurveBox[{
          2, {1.4996551408641468`, -0.16455400884128957`}, 1}], 
          0.02261146111623527], 
         ArrowBox[BezierCurveBox[{
          3, {0.4996553782289282, 0.16432740746005672`}, 1}], 
          0.02261146111623527]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.02261146111623527], DiskBox[2, 0.02261146111623527], 
         DiskBox[3, 0.02261146111623527]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.9179652038897457`*^9, 3.9179652587669888`*^9}},
 CellLabel->"Out[64]=",ExpressionUUID->"815f4064-ad6d-4a0d-b601-6b7cc83d135c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DirectedGraph", "[", 
  RowBox[{"rule", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.917965204356094*^9, 3.917965263923128*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"8846a45c-7ea9-425f-aec1-5777d577cf31"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4}, {
       SparseArray[
       Automatic, {4, 4}, 0, {
        1, {{0, 2, 4, 5, 8}, {{2}, {4}, {1}, {4}, {4}, {1}, {2}, {3}}}, 
         Pattern}], Null}]]}, 
    TagBox[GraphicsGroupBox[GraphicsComplexBox[CompressedData["
1:eJw1VHk0VWsb3yRfHwl1SUJ0K4mkXNJp+J1SIhkylSTzEBlLFyWpyCVJJbnJ
jRTHQhooknlK5uEYc3DMuSiHuoZzvvf74+619trr2etZ7/t7nt+gYO9l4sRP
UdRN8v7/GxuewdpykKJT/z7dYW9ukXowZiaeLfMV//5OYHw0zpHtRt5T/5x9
3d8QqsTt3CDXjcUuxZSVfBS94JRz0tBoLrZQutLjbB4s3t29plRcgPuZ5RKH
anjo1jJ39bMowe3ue+5qOTw4zbiUtZiXIyFtR2xJCg86idoB585UwczZyYD3
iIeqawNf3V1rsLUzPGI6hofdy6ijIv518JqyDIyP5mHsfXl14eFG2OxMnh4m
NV9NmWf+/ACOJzfP6t7jwdvy0rxEERsTX9VT7eN5kKcVFixeH0S4SlTjjuc8
iB3QeT9/ZAgJp6T8GATP45rIgIT/DMPL7HlLBcGrJ0uz8qoaxniQ7Xn/QR7O
BgnX8IWOIOeJjIAlmTdOaUU4G6PQcvOfXMjhghLzNis6EYYLbUbr+g5yQQ+J
iEg6EwVa9Fbe/folUF2ZhfNx9+Gh+J1tdWYJ8rEfv3MG4hH3Zpfr5a+LkHe/
WVla8RSO9ou2GlcWkZ0e2xuj8xzyoVbZn1ctwpYSUt/vk47qK2Zywc8W4Fod
03RaIRtuY9tHxKtmkaD1IMi2tA7iYvYLCmdnwTn92iXWpgGbzHzba39wECgW
vM/iXiNEP2usNnrAQU9Rau7x8CaIL+u6z1bnQFNVOEQmphllJ/gvlDFnINjq
3LQ1owXtFfPNm4NmMFlnIl7T0Qq7otVlUJyB/YPLBw0lmXgcLjyVFELR6ysr
hyrJPm46iIbl3aXo84H953pvjqBu5YnwqCcU/aV2L3TIPhtnz1lLplH0lbHr
GJ5k37rRj6sNsim6aXry3k+Ej/PZ1yZUcyn622/zidWEL/4fkwa5eRR9bYy6
bl8hGyx3QWZ/PkX30YjRuEn4Hjk2IP2B1FXRNhYmRA8+q49JRZB+Zj8nSPP3
Ojz1iMdSDkUXt2m7+NilBqZ1E+mS5L5TRjlhz6yqoLc7taMzlaIryf4VIkP0
aJNny9AneL2bh+YbzUuQvGmZtS+ZRyuFHryqqAD9FZLR5mRez0NW0RTRO91N
U+S7Jg8it6TYIvGjMIqUcF7ezwUvRXjaeH4EjDgfY7tbXFx93SIh6DiCAT4P
Fm0bFzkhL43DmMNYKBajffq0BMFvQq6bTYYh/jol8IjzEs4eHyzY2T6En3Z9
t8d5i5Dd6bie4zQEK+0VwrMPFxHkWRb9kjuIlZ7x1rT8OUhmKMVe38xC1a9P
zo8azsE5seW7k3svtOSOxwX0z4IqHpv7tfIL/jDLTVP1nUW4C3+gnOYX/G7b
EKrHN4uagq6S9A89MH3jJigSzcG+j52G4id7MLmUWlewngPu3MZXUSt68HPP
iMKT1BlQTiZOho3diEwsc/5DpRDMHI+Y1JIvyK/d5fhjshRiPnoP6217sYc5
daC1rRKTUiqvpEd78Sh4Y3dkdQ3G3mVX7j3JwkB9yOeq8nqY5KYLTWeyYFys
QEk6NiHvH2lFgQkWTLPtJFVcW2B541gmY0UfggOZcRc92jC/mq+KvaoPbieH
GO94o5i7lyrxD6nlGapLVvzjUDAP4ZWQfjG3abgIfEX6o7UNNHKed+RbBn35
BLbISrxUyWJBVG29orHA3wi37TlzleAJ3j30hktN4vaVkW0OBG/iwbNvc+cn
ccVruF/GrheVe74ZDE5PwUqkNn6BzJtx1DLsDtmHIOM0K8a9C949IVbpZF9X
2hh1NPUupG9k+M3d4WBYf43q08FOXIpg3VUl+/7NuDliOrgTBtzElaKED4WE
7SEuyzsRbNS2xpzwpXZROdHArwPlKpfKCwmfgWMJ6j8b2iGjEWQhTPg+/y5+
8yeJdgRWP4vyJ3rwlnbVZAVUoyXJK8CV6EX6p97x9J5KFFvbPPnotASpXVza
/bUVaBt+bL+X6M2sJUPnhXIZWrJ+9L1Q4iJ5buiVoHQJFGwb+KrCSJ5ZWG/s
qfoIkQlmkmMfF7aemRtPSuThxvfCV8eI3m+bCdnrbHiLwAkj0dMkD/7c0PVs
aHUf3D975+qQvGDwjTxMftUH8aJfasdJnihz5Hz+PtqPDrN1+8V/44CzSVvT
o60fRbF+A9dJHiXnjMjVWw6AkdKfJPiTA/3Tq2pKWgdQynkebUfyLNLvjjvv
CBs2a66KnyR5p6y144d2JhtZoxOF4ikLSGy03rdr3Rg4u8ZeOogu4lJ7eBT9
0hhuaNFCm0meplUGRfZXj2Enf+MF2YlFDPp+0xsUG4f2XO5DfuslHNZdvkXO
cBzOz9ZLomEJQtWhLLdr46g71WsYfYiLbcp2WRmp4yiV+Ws+K5cLpYt6ZrVl
40iqkzowSvRgKGsYvz2wA4fvDMZ8IHr5xd73gWB3Owb1NawE+CahmR8dkG/a
jttJWy9aEL3R1gs7xg8ykV8n5n+U6LFVRlx+KIoJfbs+N0+iV7fOp8uajJjQ
O1ds40D07Fu7pTFkGxPqAoIbioje1TLzEkTkmBBrXXv9BvGDVuZ53oAsEylq
od004peBrXnKJ0h/RRafxSbip0BaitWf5Lz/dnwXYBO/Lea8uJxG7os6ckr0
OfFjgi+rzoLgaVJU6xknfn1k0crzIXhNefpdQlOlSHNo033f1Q6H/dRoGvF7
dcXU3c6ADvwPcTApSw==
       "], {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         ArrowBox[BezierCurveBox[{
          1, {1.892577988620065, 0.42366861832864927`}, 2}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          1, {1.5042427712014406`, 0.06126400516296312}, 4}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          2, {2.171231549273011, 0.42360787921316845`}, 1}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          2, {1.643661893475537, 0.4848718843761458}, 4}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          3, {0.5580081698563638, 0.6072208830395353}, 4}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          4, {1.6435943491643665`, 0.36244964352212095`}, 1}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          4, {1.5043599107855192`, 0.7861182618507672}, 2}], 
          0.022870558906025296`], 
         ArrowBox[BezierCurveBox[{
          4, {0.558016523510532, 0.2401810141354148}, 3}], 
          0.022870558906025296`]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.022870558906025296], DiskBox[2, 0.022870558906025296], 
         DiskBox[3, 0.022870558906025296], 
         DiskBox[4, 0.022870558906025296]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.91796520913395*^9, 3.917965264109211*^9}},
 CellLabel->"Out[65]=",ExpressionUUID->"89f96832-c6f1-42f4-b0a8-5952417d2451"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"RulePlot", "[", 
  RowBox[{"wm", "[", "rule", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.917965239524146*^9, 3.917965241502768*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"1a8d8901-3060-4358-9d40-e664c2b5b0f5"],

Cell[BoxData[
 GraphicsBox[
  GeometricTransformationBox[
   GeometricTransformationBox[
    GeometricTransformationBox[{
      GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[{{{
            {RGBColor[0.5, 0.5, 0.95], Opacity[
             1], {LineBox[{{2.0412627751064836`, 0.0999999976243759}, {
               2.041339329230882, 0.4512082624317267}}], 
              PolygonBox[{{2.1282594597899824`, 0.4206013154126445}, {
               2.118455613489219, 0.42543645250697887`}, {2.094750442010248, 
               0.4361216198618948}, {2.0804101547199965`, 
               0.4416867457978509}, {2.066070069915193, 0.4466668716757732}, {
               2.0526073739341015`, 0.4500358062678372}, {2.041339329230882, 
               0.4512082624317266}, {2.0310950944451527`, 
               0.4500404953765089}, {2.0179237610589684`, 
               0.44667736629929666`}, {2.0029957565590712`, 
               0.44170362009171266`}, {1.9877746445515907`, 
               0.43614493775992536`}, {1.9618703172090972`, 
               0.42547058396529447`}, {1.950893464003532, 
               0.4206399765145207}, {2.041404721304689, 0.7512082553048544}, {
               2.1282594597899824`, 0.4206013154126445}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.9433467277226748`, 0.02041361829445744}, {
               0.3915770001034932, 0.3439998850275896}}], 
              PolygonBox[{{0.43926579844899377`, 0.4228521063951718}, {
               0.43253303448509, 0.41424026324655605`}, {0.4172383700251682, 
               0.39321215835552026`}, {0.40886587277102954`, 
               0.3803080599375973}, {0.4010661242444826, 
               0.36728486490367696`}, {0.3950226305790703, 
               0.35479206346920994`}, {0.3915770001034932, 
               0.3439998850275896}, {0.39063119585343536`, 
               0.333732778299744}, {0.3912377202982164, 
               0.32015239581404487`}, {0.3930627926500851, 
               0.3045238136455677}, {0.39540073854572605`, 
               0.288489001236342}, {0.40056830903785895`, 
               0.2609522581607923}, {0.4030589802248464, 
               0.24922099089428135`}, {0.0978942500258733, 
               0.40524073991096193`}, {0.43926579844899377`, 
               0.4228521063951718}}]}}}, {
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.041240977748548, 0.}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.0414265186626244, 0.8512082529292303}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0., 0.42565435820541936}, 0.1]}}}, {}, 
          {GrayLevel[0.7], 
           LineBox[{{-0.32414265186626245`, -0.20512082529292308`}, {
            2.365569170528887, -0.20512082529292308`}, {2.365569170528887, 
            1.0563290782221533`}, {-0.32414265186626245`, 
            1.0563290782221533`}, {-0.32414265186626245`, \
-0.20512082529292308`}}]}}, {0.32414265186626245`, 0.20512082529292308`}], {{{
         0.37178704115205713`, 0.}, {0., 0.37178704115205713`}}, {0., 0.}}], {
       0, 0}], GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[
         {GrayLevel[0.65], 
          FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 
           0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{-1., 
           0.1848}, {0.2991, 0.1848}, {-0.1531, 0.6363}, {0.109, 0.8982}, {1.,
            0.0034}, {0.109, -0.8982}, {-0.1531, -0.6363}, {
           0.2991, -0.1848}, {-1., -0.1848}, {-1., 0.1848}}}]}, {1.4, 
         0.2344953635947091}], {{{0.075, 0.}, {0., 0.075}}, {0., 
         0.2169082113251059}}], {1., 0}], 
      GeometricTransformationBox[
       GeometricTransformationBox[GeometricTransformationBox[{{{
            {RGBColor[0.5, 0.5, 0.95], Opacity[
             1], {LineBox[{{2.0412627751064836`, 0.0999999976243759}, {
               2.041339329230882, 0.4512082624317267}}], 
              PolygonBox[{{2.1282594597899824`, 0.4206013154126445}, {
               2.118455613489219, 0.42543645250697887`}, {2.094750442010248, 
               0.4361216198618948}, {2.0804101547199965`, 
               0.4416867457978509}, {2.066070069915193, 0.4466668716757732}, {
               2.0526073739341015`, 0.4500358062678372}, {2.041339329230882, 
               0.4512082624317266}, {2.0310950944451527`, 
               0.4500404953765089}, {2.0179237610589684`, 
               0.44667736629929666`}, {2.0029957565590712`, 
               0.44170362009171266`}, {1.9877746445515907`, 
               0.43614493775992536`}, {1.9618703172090972`, 
               0.42547058396529447`}, {1.950893464003532, 
               0.4206399765145207}, {2.041404721304689, 0.7512082553048544}, {
               2.1282594597899824`, 0.4206013154126445}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.9529468894364896`, 0.04199096118422422}, {
               1.4866924417101448`, 0.25771603153241923`}}], 
              PolygonBox[{{1.548491962513333, 0.3237636384373634}, {
               1.5399885246189315`, 0.31689446840117597`}, {
               1.5203407133603353`, 0.29986298376252585`}, {1.509270697957645,
                0.28918266423386946`}, {1.4987317471943653`, 
               0.2782569970790424}, {1.4900234566075339`, 
               0.2674514624592189}, {1.4842299369899343`, 
               0.2577160315324191}, {1.4809902434628923`, 
               0.2479276500476566}, {1.4785146488506289`, 
               0.23456104645228756`}, {1.4767636473026449`, 
               0.21892399227749626`}, {1.475420546705822, 
               0.20277539231351138`}, {1.4742368520757305`, 
               0.17478298493181776`}, {1.474014274299322, 
               0.1627922996397484}, {1.211960157893126, 0.3836889150850917}, {
               1.548491962513333, 0.3237636384373634}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{1.9506610060938625`, 0.8092365752390317}, {
               1.4842656151359044`, 0.5935665870301103}}], 
              PolygonBox[{{1.4755443337980338`, 0.6853044393816109}, {
               1.4752729176014319`, 0.6743764804569891}, {1.4755295963474917`,
                0.6483756713874366}, {1.4765005866943572`, 
               0.6330240706892587}, {1.4780024167832133`, 0.61791830383176}, {
               1.4805980770757943`, 0.6042853859118715}, {1.4842656151359044`,
                0.5935665870301103}, {1.4896271419012073`, 
               0.5847596547046442}, {1.4982102308361371`, 
               0.5742180587773149}, {1.5089927091481583`, 
               0.5627584937272271}, {1.5204291343300034`, 
               0.551278538192903}, {1.5409943950276623`, 
               0.5322510303046555}, {1.5499878196500314`, 
               0.5243172803589006}, {1.2119690774296186`, 
               0.4676515539595145}, {1.4755443337980338`, 
               0.6853044393816109}}]}}, 
            {Hue[0.63, 0.7, 0.5], Opacity[
             0.7], {LineBox[{{0.0999999999741002, 0.425656634158216}, {
               0.7212035649644559, 0.4256707724581295}}], 
              PolygonBox[{{0.6906175433853138, 0.33874327631220197`}, {
               0.6954503202291663, 0.3485482863064612}, {0.706129780654891, 
               0.37225602937207963`}, {0.71169145424768, 
               0.3865976559568598}, {0.7166681278481313, 
               0.4009389392273161}, {0.7200338214259479, 
               0.41440244583240027`}, {0.7212035649644559, 
               0.4256707724581295}, {0.7200333318166097, 
               0.4359147258268286}, {0.7166670320608425, 
               0.4490852492148463}, {0.7116896923324783, 
               0.4640120559368096}, {0.7061273459361792, 
               0.47923182934437314`}, {0.6954467564216519, 
               0.5051335862659059}, {0.6906135066188765, 
               0.5161092762662645}, {1.0212035648867566`, 
               0.4256776003165193}, {0.6906175433853138, 
               0.33874327631220197`}}]}}}, {
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.041240977748548, 0.}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{2.0414265186626244, 0.8512082529292303}, 0.1]}, 
            {RGBColor[0.5, 0.5, 0.95], EdgeForm[{GrayLevel[0], Opacity[0.7]}],
              DiskBox[{0., 0.42565435820541936}, 0.1]}, 
            {Hue[0.63, 0.26, 0.89], EdgeForm[{Hue[0.63, 0.7, 0.33], Opacity[
             0.95]}], 
             DiskBox[{1.1212035648608567, 0.42567987626931586}, 0.1]}}}, {}, 
          {GrayLevel[0.7], 
           LineBox[{{-0.32414265186626245`, -0.20512082529292308`}, {
            2.365569170528887, -0.20512082529292308`}, {2.365569170528887, 
            1.0563290782221533`}, {-0.32414265186626245`, 
            1.0563290782221533`}, {-0.32414265186626245`, \
-0.20512082529292308`}}]}}, {0.32414265186626245`, 0.20512082529292308`}], {{{
         0.37178704115205713`, 0.}, {0., 0.37178704115205713`}}, {0., 0.}}], {
       1.21, 0}]}, {0.13, 0.13}], {{{1., 0.}, {0., 1.}}, {0., 0.}}], {0, 0}],
  Background->None,
  ImagePadding->{{0., 0.}, {0., 0.}},
  ImageSizeRaw->318.7199999999999,
  PlotRange->{{-0.01, 2.4799999999999995`}, {-0.01, 0.7389907271894182}},
  PlotRangePadding->Automatic]], "Input",
 CellChangeTimes->{{3.917965363288536*^9, 
  3.917965363395998*^9}},ExpressionUUID->"4913a0ef-2d54-49f2-a5df-\
b69d607a754e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ruleForm", " ", "=", " ", 
  RowBox[{"Apply", "[", 
   RowBox[{"Rule", ",", " ", "rule", ",", " ", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.917965328854054*^9, 3.91796534508414*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"89bd1435-71c6-4a08-94c7-16099a101c0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "\[Rule]", "2"}], ",", 
    RowBox[{"1", "\[Rule]", "3"}]}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"1", "\[Rule]", "2"}], ",", 
    RowBox[{"1", "\[Rule]", "4"}], ",", 
    RowBox[{"2", "\[Rule]", "4"}], ",", 
    RowBox[{"3", "\[Rule]", "4"}]}], "}"}]}]], "Output",
 CellChangeTimes->{{3.9179653336652*^9, 3.917965345601802*^9}},
 CellLabel->"Out[68]=",ExpressionUUID->"a8a5d1f8-9fe7-4599-8ef1-52405824300a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.917965436890346*^9, 3.917965437364996*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"237aa9d1-d1ae-47c0-95f8-53a6152dd08a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", " ", "=", " ", 
  RowBox[{"Graph", "[", 
   RowBox[{"ruleForm", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.917965437790679*^9, 3.917965444783463*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"aeb2aad6-85df-4589-960e-f35ec9bd2491"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {{{1, 2}, {1, 3}}, Null}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{0.4472135954999579, 0.8944271909999159}, {0., 
       0.}, {0.8944271909999159, 0.}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         ArrowBox[{{1, 2}, {1, 3}}, 0.011386058141428929`]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.011386058141428929], DiskBox[2, 0.011386058141428929], 
         DiskBox[3, 0.011386058141428929]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.917965442165292*^9, 3.917965445084805*^9}},
 CellLabel->"Out[73]=",ExpressionUUID->"1654a592-7c91-4e8e-8fa3-8f0e3eebf6ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EdgeList", "@", "g"}]], "Input",
 CellChangeTimes->{{3.917965446798074*^9, 3.91796545029104*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"bc457406-f2d1-4d0f-b5fd-5e443ef8b64b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
   RowBox[{"1", "\[DirectedEdge]", "3"}]}], "}"}]], "Output",
 CellChangeTimes->{3.917965450615114*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"934d40a6-e2fb-4532-8e0f-9c44b0153014"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VertexList", "@", "g"}]], "Input",
 CellChangeTimes->{{3.91796545132023*^9, 3.917965453591963*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"b651665c-5741-41f9-9d19-02e02733bd93"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.917965453833199*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"8ebba461-c8b4-4ca2-a9e5-d27371f31e59"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutate single graph", "Section",
 CellChangeTimes->{{3.9180546105078707`*^9, 
  3.918054624278653*^9}},ExpressionUUID->"96900d83-48bf-40b9-955b-\
6d6c8cbf8a57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"addRandomConnection", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"EdgeAdd", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"Rule", " ", "@@", " ", 
     RowBox[{"RandomChoice", "[", 
      RowBox[{
       RowBox[{"VertexList", " ", "@", " ", "g"}], ",", " ", "2"}], "]"}]}]}],
    "]"}]}], "\n", 
 RowBox[{
  RowBox[{"addRandomEdge", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"EdgeAdd", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"Rule", "[", 
     RowBox[{
      RowBox[{"RandomChoice", "[", 
       RowBox[{"VertexList", " ", "@", " ", "g"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"VertexCount", "[", "g", "]"}], " ", "+", " ", "1"}]}], 
     "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.917965462242111*^9, 3.917965543638404*^9}, {
  3.917965599403514*^9, 3.917965629863401*^9}, {3.917965660232607*^9, 
  3.917965790688205*^9}, {3.917965857049798*^9, 3.917965920588194*^9}, {
  3.918054112905101*^9, 3.918054114324337*^9}, {3.918054494025898*^9, 
  3.918054494412499*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"a0b14ced-e7c7-4bde-9d90-b4ed127f9b58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"deleteRandomEdge", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"EdgeDelete", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{"EdgeList", " ", "@", " ", "g"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"deleteRandomVertex", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{"VertexDelete", "[", 
   RowBox[{"g", ",", " ", 
    RowBox[{"RandomChoice", "[", 
     RowBox[{"VertexList", " ", "@", " ", "g"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.917965462242111*^9, 3.917965543638404*^9}, {
   3.917965599403514*^9, 3.917965629863401*^9}, {3.917965660232607*^9, 
   3.917965790688205*^9}, {3.917965857049798*^9, 3.917965972281178*^9}, 
   3.917966109068243*^9, {3.918054010922871*^9, 3.918054047617416*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"a5a0dd94-d546-4cd0-82ca-dbc9f41da27f"],

Cell[CellGroupData[{

Cell[BoxData["g"], "Input",
 CellChangeTimes->{3.91805600830599*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"203142d6-bf1e-40bd-913f-7338255ab408"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {{{1, 2}, {1, 3}}, Null}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{0.4472135954999579, 0.8944271909999159}, {0., 
       0.}, {0.8944271909999159, 0.}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         ArrowBox[{{1, 2}, {1, 3}}, 0.011386058141428929`]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.011386058141428929], DiskBox[2, 0.011386058141428929], 
         DiskBox[3, 0.011386058141428929]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.918056008465474*^9},
 CellLabel->
  "Out[169]=",ExpressionUUID->"d5a4384e-b29b-4560-9a6f-026073fcfc44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VertexList", "@", "g"}]], "Input",
 CellChangeTimes->{{3.9180560091871347`*^9, 3.918056011243964*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"e99a4beb-f5d4-4d3e-9394-6ac1c354ae58"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.918056011422727*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"037fb27e-76c2-4fd5-99c1-81a3fb10353d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EdgeList", "@", "g"}]], "Input",
 CellChangeTimes->{{3.9180560149672823`*^9, 3.918056017423263*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"1a87ffd7-a37f-4ef4-8cbb-2a97789f67e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"1", "\[DirectedEdge]", "2"}], ",", 
   RowBox[{"1", "\[DirectedEdge]", "3"}]}], "}"}]], "Output",
 CellChangeTimes->{3.918056017650161*^9},
 CellLabel->
  "Out[171]=",ExpressionUUID->"e93aa095-da08-4759-be10-be50a35eef0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"modifyRandomElement", "[", "g_", "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", "reverseRandomEdge"}]], "Input",
 CellChangeTimes->{{3.91805595401062*^9, 
  3.918055982513419*^9}},ExpressionUUID->"6711dbd1-d832-4e24-8d71-\
0b0cf3bacba9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"operations", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "addRandomConnection", ",", " ", "addRandomEdge", ",", " ", 
     "deleteRandomEdge", ",", " ", "deleteRandomVertex"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"mutate", "[", "g_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"RandomChoice", "[", "operations", "]"}], " ", "@", " ", 
   "g"}]}]}], "Code",
 CellChangeTimes->{{3.918054522689885*^9, 3.918054535952924*^9}, {
  3.9180545694882097`*^9, 
  3.918054575480606*^9}},ExpressionUUID->"526989ea-9270-4a03-93de-\
0f55198580ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mutate", "[", "g", "]"}]], "Input",
 CellChangeTimes->{{3.9180545516445417`*^9, 3.918054554886344*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"9ea08062-709b-4fe8-b08d-83f227f72c99"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3}, {{{1, 2}, {1, 3}, {1, 2}}, Null}]]}, 
    TagBox[GraphicsGroupBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGBQBmIQjQo+2GMIoYkLnIhSF3q7yF5Z2In7/Lw39g7lu45f
T1xuby9+cK/lodf2DmuVX8/RXm2/9vZ+k4pHr+wTmo4nKXuss9eaOfk1H8Mr
+xMmbSdPRm2wZ3Hj/NAs/dI+YkLKUTvLjfZly9kmx5m+sN8Q1f/uzb6N9i5i
ORLqfs/tPwTukGt9vdE+JQ0EnsH5xmBwGa6++LL6+Y3JF+HmKSY93dyqdR5u
34vnt+w/TDxtHwB1T8DsjYFH/h+3N4C612Uig6582RF7A6h//i36zSH5/YA9
A9S/19LeL23n3G0P9f9+NP/vR/P/fjT/70fz/340/+9H8/9+NP/vR/P/fjT/
70fz/340/+9H8/9+NP/vR/P/fjT/74f5HwDkbQSG
       "], {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
         ArrowBox[BezierCurveBox[{
          1, {0.1644407471831164, 0.5000000000000003}, 2}], 0.01273], 
         ArrowBox[BezierCurveBox[{
          1, {-0.1644407471831164, 0.5000000000000003}, 2}], 0.01273], 
         ArrowBox[{1, 3}, 0.01273]}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.01273], DiskBox[2, 0.01273], DiskBox[3, 0.01273]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{{3.9180545552653522`*^9, 3.918054559966939*^9}},
 CellLabel->
  "Out[166]=",ExpressionUUID->"4fdbf27a-f02a-4fa6-9c8b-eb2ee05b50db"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mutate single WM rule", "Section",
 CellChangeTimes->{{3.9180552743554087`*^9, 
  3.91805527711625*^9}},ExpressionUUID->"ff0cf7ef-a81a-4eac-adae-\
2dec9d170b9f"],

Cell[CellGroupData[{

Cell[BoxData["rule"], "Input",
 CellChangeTimes->{{3.918055278719739*^9, 3.9180552789156218`*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"a4f98030-6200-406d-a1d0-af7bb136a6e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], "}"}], "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.9180552791878767`*^9},
 CellLabel->
  "Out[168]=",ExpressionUUID->"cb0d1aaa-26a3-4df6-aa04-8f2512a5cd18"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{767, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b72eea2d-2bf6-4d20-a8e1-79b4cdda5b04"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 212, 5, 35, "Text",ExpressionUUID->"e51c8c07-76aa-4455-a590-c7b14a4c5798"],
Cell[CellGroupData[{
Cell[795, 29, 267, 4, 30, "Input",ExpressionUUID->"854151f4-83d8-48de-ae36-d3f9db7ddb25"],
Cell[1065, 35, 7597, 191, 39, "Output",ExpressionUUID->"6509b146-d030-4e38-b02f-41e59bc84aa4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8699, 231, 540, 14, 30, "Input",ExpressionUUID->"04583e98-4db3-4f3d-a259-59abb8262500"],
Cell[9242, 247, 670, 20, 34, "Output",ExpressionUUID->"a30fb799-45bd-44eb-84e1-02f58bcb340e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9949, 272, 324, 7, 30, "Input",ExpressionUUID->"a36710c9-3ad5-42df-9782-5c7854e52c02"],
Cell[10276, 281, 15367, 236, 201, "Output",ExpressionUUID->"1da7c11e-36ab-4781-8a5b-81646f2749ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25680, 522, 237, 4, 30, "Input",ExpressionUUID->"bb20c6c1-a720-4c74-befc-20b346817341"],
Cell[25920, 528, 9687, 157, 127, "Output",ExpressionUUID->"86145faf-2f10-4fcf-bdb2-206ab4533e0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35644, 690, 295, 6, 30, "Input",ExpressionUUID->"60b58a8f-9f64-45f0-83b8-94959425305a"],
Cell[35942, 698, 646, 20, 34, "Output",ExpressionUUID->"4265e04c-921f-449b-9545-2a271a6dd7d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36625, 723, 891, 25, 52, "Input",ExpressionUUID->"7953a065-6d22-4939-82ca-049593a387cf"],
Cell[37519, 750, 697, 20, 34, "Output",ExpressionUUID->"aed7836a-48d5-4540-a58b-b2fcb1721eb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38253, 775, 266, 5, 30, "Input",ExpressionUUID->"13ca6d7b-97be-4dd9-bae8-1a987e1b4f54"],
Cell[38522, 782, 2547, 50, 87, "Output",ExpressionUUID->"815f4064-ad6d-4a0d-b601-6b7cc83d135c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41106, 837, 266, 5, 30, "Input",ExpressionUUID->"8846a45c-7ea9-425f-aec1-5777d577cf31"],
Cell[41375, 844, 4888, 93, 172, "Output",ExpressionUUID->"89f96832-c6f1-42f4-b0a8-5952417d2451"]
}, Open  ]],
Cell[46278, 940, 238, 4, 30, "Input",ExpressionUUID->"1a8d8901-3060-4358-9d40-e664c2b5b0f5"],
Cell[46519, 946, 9629, 158, 109, InheritFromParent,ExpressionUUID->"4913a0ef-2d54-49f2-a5df-b69d607a754e"],
Cell[CellGroupData[{
Cell[56173, 1108, 317, 6, 30, "Input",ExpressionUUID->"89bd1435-71c6-4a08-94c7-16099a101c0d"],
Cell[56493, 1116, 499, 13, 34, "Output",ExpressionUUID->"a8a5d1f8-9fe7-4599-8ef1-52405824300a"]
}, Open  ]],
Cell[57007, 1132, 171, 2, 30, "Input",ExpressionUUID->"237aa9d1-d1ae-47c0-95f8-53a6152dd08a"],
Cell[CellGroupData[{
Cell[57203, 1138, 297, 6, 30, "Input",ExpressionUUID->"aeb2aad6-85df-4589-960e-f35ec9bd2491"],
Cell[57503, 1146, 1027, 21, 376, "Output",ExpressionUUID->"1654a592-7c91-4e8e-8fa3-8f0e3eebf6ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58567, 1172, 200, 3, 30, "Input",ExpressionUUID->"bc457406-f2d1-4d0f-b5fd-5e443ef8b64b"],
Cell[58770, 1177, 270, 6, 34, "Output",ExpressionUUID->"934d40a6-e2fb-4532-8e0f-9c44b0153014"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59077, 1188, 202, 3, 30, "Input",ExpressionUUID->"b651665c-5741-41f9-9d19-02e02733bd93"],
Cell[59282, 1193, 204, 4, 34, "Output",ExpressionUUID->"8ebba461-c8b4-4ca2-a9e5-d27371f31e59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59523, 1202, 166, 3, 67, "Section",ExpressionUUID->"96900d83-48bf-40b9-955b-6d6c8cbf8a57"],
Cell[59692, 1207, 1114, 27, 72, "Code",ExpressionUUID->"a0b14ced-e7c7-4bde-9d90-b4ed127f9b58"],
Cell[60809, 1236, 866, 18, 72, "Code",ExpressionUUID->"a5a0dd94-d546-4cd0-82ca-dbc9f41da27f"],
Cell[CellGroupData[{
Cell[61700, 1258, 151, 3, 30, "Input",ExpressionUUID->"203142d6-bf1e-40bd-913f-7338255ab408"],
Cell[61854, 1263, 1007, 22, 376, "Output",ExpressionUUID->"d5a4384e-b29b-4560-9a6f-026073fcfc44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62898, 1290, 209, 4, 30, "Input",ExpressionUUID->"e99a4beb-f5d4-4d3e-9394-6ac1c354ae58"],
Cell[63110, 1296, 208, 5, 34, "Output",ExpressionUUID->"037fb27e-76c2-4fd5-99c1-81a3fb10353d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63355, 1306, 207, 4, 30, "Input",ExpressionUUID->"1a87ffd7-a37f-4ef4-8cbb-2a97789f67e9"],
Cell[63565, 1312, 274, 7, 34, "Output",ExpressionUUID->"e93aa095-da08-4759-be10-be50a35eef0e"]
}, Open  ]],
Cell[63854, 1322, 274, 6, 52, "Input",ExpressionUUID->"6711dbd1-d832-4e24-8d71-0b0cf3bacba9"],
Cell[64131, 1330, 588, 16, 72, "Code",ExpressionUUID->"526989ea-9270-4a03-93de-0f55198580ec"],
Cell[CellGroupData[{
Cell[64744, 1350, 210, 4, 30, "Input",ExpressionUUID->"9ea08062-709b-4fe8-b08d-83f227f72c99"],
Cell[64957, 1356, 1517, 30, 332, "Output",ExpressionUUID->"4fdbf27a-f02a-4fa6-9c8b-eb2ee05b50db"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66523, 1392, 167, 3, 67, "Section",ExpressionUUID->"ff0cf7ef-a81a-4eac-adae-2dec9d170b9f"],
Cell[CellGroupData[{
Cell[66715, 1399, 181, 3, 30, "Input",ExpressionUUID->"a4f98030-6200-406d-a1d0-af7bb136a6e0"],
Cell[66899, 1404, 603, 20, 34, "Output",ExpressionUUID->"cb0d1aaa-26a3-4df6-aa04-8f2512a5cd18"]
}, Open  ]]
}, Open  ]]
}
]
*)

